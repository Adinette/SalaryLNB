var _=Object.defineProperty;var E=(e,s,t)=>s in e?_(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var f=(e,s,t)=>E(e,typeof s!="symbol"?s+"":s,t);import{bU as u,ah as v,ai as R,bV as U,ak as D,k as y,c as k,m as A,a4 as L,a3 as b,a2 as d}from"./index-djH96c7W.js";import{a as q,b as h,A as o,N as g}from"./api_route-BfCuro4K.js";import{f as x}from"./chunk-TVFJBHBT-BUrEn1b-.js";const T={};function C(e,s){e.elements.push(s)}function O(e,{id:s}){return e.elements.find(t=>t.id===s)}function z(e,{id:s,data:t}){const r=e.elements.findIndex(a=>a.id===s);r!==-1&&(e.elements[r]={...e.elements[r],...t})}function j(e,{id:s}){e.elements=e.elements.filter(t=>t.id!==s)}class l extends q{get store(){return m()}async request(){const s=await this.store;s.setLoading(!0);const t=await super.request();return s.setLoading(!1),t}}f(l,"name","users");const F={id:"039dd848-52a2-4913-8d7e-5108a19a649c",first_name:"Rostrand",last_name:"FaurÃ©",email:"rost.faure@bj.com",phone:"229 96 12 34 56",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},G={id:"a84cc86e-4116-4102-8457-118af39ba8eb",first_name:"Afi",last_name:"Rutherford",email:"afi.rutherford@bj.com",phone:"229 96 12 34 55",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},M=[F,G];class B extends l{constructor(s={}){super(`/${l.name}`,h.GET,s)}async request(){const s=await super.request();return s instanceof o?s:s.map(t=>new u(t))}async mock(){const s=await this.store;s.elements.length===0&&(s.elements=[...M]);let t=s.elements.map(r=>new u(r));if(console.log(t),this.data&&this.data.search){const r=this.data.search.toLowerCase();t=t.filter(a=>a.first_name.toLowerCase().includes(r)||a.last_name.toLowerCase().includes(r)||a.email.toLowerCase().includes(r)||a.phone&&a.phone.toLowerCase().includes(r))}return t}}async function N(e,{args:s}={}){const r=await new B(s).mock();return r instanceof o?[]:(e.elements=r.map(a=>a.interface),r)}class P extends l{constructor({elementId:t}){super(`/${l.name}/${t}`,h.GET,{id:t});f(this,"elementId");this.elementId=t}async request(){const t=await super.request();return t instanceof o?t:new u(t)}async mock(){const r=(await this.store).find(this.elementId);return r?new u(r):new g({message:`Utilisateur avec l'ID ${this.elementId} non trouvÃ©`})}}async function V(e,{elementId:s}){const r=await new P({elementId:s}).mock();return r instanceof o,r}class H extends l{constructor(t){super(`/${l.name}`,h.POST,t);f(this,"data");this.data=t}async request(){const t=await super.request();return t instanceof o?t:new u(t)}async mock(){const t=await this.store,r=new u({...this.data,id:x.string.uuid(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()});return t.add(r.interface),r}}async function J(e,{data:s}){const r=await new H(s).mock();return r instanceof o,r}class K extends l{constructor(t,r){super(`/${l.name}/${t}`,h.PUT,r);f(this,"elementId");f(this,"data");this.elementId=t,this.data=r}async request(){const t=await super.request();return t instanceof o?t:new u(t)}async mock(){const t=await this.store,r=t.find(this.elementId);if(!r)return new g({message:`Aucun utilisateur trouvÃ© avec l'ID ${this.elementId}.`});const a=new u({...r,...this.data,updated_at:new Date().toISOString()});return t.update(this.elementId,a.interface),a}}async function Q(e,{elementId:s,data:t}){const a=await new K(s,t).mock();return a instanceof o,a}class W extends l{constructor(t){super(`/${l.name}/${t}`,h.DELETE,{elementId:t});f(this,"elementId");this.elementId=t}async request(){const t=await super.request();return t instanceof o?t:new u(t)}async mock(){const t=await this.store,r=t.find(this.elementId);return r?(t.remove(this.elementId),new u(r)):new g({message:`Aucun utilisateur trouvÃ© avec l'ID ${this.elementId}.`})}}async function X(e,{elementId:s}){const r=await new W(s).mock();return r instanceof o,r}async function Y(e,s={}){e.loading=!0,v.info(`[ğŸ][${e.$id}]: Executing setUsers()`),e.elements=s.users||[],e.loading=!1,v.success(`[ğŸ][${e.$id}]: setUsers() completed`)}const c={setUsers:Y,...R(U.service),add:C,find:O,update:z,remove:j,getUsers:N,findUser:V,createUser:J,updateUser:Q,deleteUser:X},Z=D(U.key,{state:()=>structuredClone(U.service.defaults),getters:T,actions:{add(e){return c.add(this,e)},find(e){return c.find(this,{id:e})},update(e,s){return c.update(this,{id:e,data:s})},remove(e){return c.remove(this,{id:e})},getUsers(e){return c.getUsers(this,{args:e})},findUser(e){return c.findUser(this,{elementId:e})},createUser(e){return c.createUser(this,{data:e})},updateUser(e,s){return c.updateUser(this,{elementId:e,data:s})},deleteUser(e){return c.deleteUser(this,{elementId:e})},initialize({reset:e=!1}={}){return c.initialize(this,{reset:e})},setLoading(e){return c.setLoading(this,e)},setUsers(e){return c.setUsers(this,e)}}});async function m(){const e=Z();return e.initialized||await e.initialize({reset:!1}),e}const w=b("use_user_actions"),ne=()=>{const e=y(null),s=y([]),t=k(()=>e.value?e.value.loading:!0),r=async i=>{e.value||(e.value=await m());const n=await e.value.getUsers(i);if(n instanceof o)return w.error("Error fetching users:",{result:n}),d.error("Erreur lors de la rÃ©cupÃ©ration des utilisateurs"),[];s.value=[...n]},a=async i=>{e.value||(e.value=await m());const n=await e.value.findUser(i);return n instanceof o?(w.error("Error finding user:",n),d.error(`Erreur lors de la recherche de l'utilisateur avec l'ID ${i}`),null):(d.success(`Utilisateur avec l'ID ${i} trouvÃ© avec succÃ¨s.`),new u(n.interface))},I=async i=>{e.value||(e.value=await m());const n=await e.value.createUser(i);return n instanceof o?(w.error("Error creating user:",n),d.error(`Erreur lors de la crÃ©ation de l'utilisateur: ${n.message}`),n):(d.success("Utilisateur crÃ©Ã© avec succÃ¨s."),new u(n.interface))},S=async(i,n)=>{e.value||(e.value=await m());const p=await e.value.updateUser(i,n);return p instanceof o?(w.error("Error updating user:",p),d.error(`Erreur lors de la mise Ã  jour de l'utilisateur: ${p.message}`),p):(d.success("Utilisateur mis Ã  jour avec succÃ¨s."),new u(p.interface))},$=async i=>{L.showAlert({title:"ÃŠtes-vous sÃ»r?",html:`Vous Ãªtes sur le point de supprimer l'utilisateur <b class="font-mono">${i.first_name} ${i.last_name}</b>. Cette action est <b class="text-pink-950">irrÃ©versible</b>`,confirmButtonText:"Oui, supprimer",onConfirm:async()=>{e.value||(e.value=await m());const n=await e.value.deleteUser(i.id);return n instanceof o?(w.error("Error deleting user:",n),d.error(`Erreur lors de la suppression de l'utilisateur: ${n.message}`),!1):(d.success(`Utilisateur ${i.first_name} ${i.last_name} supprimÃ© avec succÃ¨s.`),r(),!0)}})};return A(async()=>{e.value=await m()}),{processing:t,users:s,getUsers:r,findUser:a,createUser:I,updateUser:S,deleteUser:$}};export{m as a,ne as u};
