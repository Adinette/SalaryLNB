var q=Object.defineProperty;var b=(t,a,e)=>a in t?q(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;var c=(t,a,e)=>b(t,typeof a!="symbol"?a+"":a,e);import{ag as x,ah as I,ai as U,bO as g,ak as T,k as y,c as L,m as C,a4 as D,a3 as z,a2 as d}from"./index-djH96c7W.js";import{a as j,b as h,A as i,N as O}from"./api_route-BfCuro4K.js";import{a as M}from"./machines-DgIDqdM-.js";class u extends x{constructor(e){super(e);c(this,"first_name");c(this,"last_name");c(this,"phone");c(this,"email");c(this,"machine");c(this,"machine_id");c(this,"is_active");this.first_name=e.first_name,this.last_name=e.last_name,this.phone=e.phone,this.email=e.email,this.machine=e.machine,this.machine_id=e.machine_id,this.is_active=e.is_active}get interface(){return{...super.interface,first_name:this.first_name,last_name:this.last_name,phone:this.phone,email:this.email,machine:this.machine,machine_id:this.machine_id,is_active:this.is_active}}get json(){return JSON.stringify(this.interface)}get fullName(){return`${this.first_name} ${this.last_name}`}}const N={};function P(t,a){t.elements.push(a)}function B(t,{id:a}){return t.elements.find(e=>e.id===a)}function G(t,{id:a,data:e}){const r=t.elements.findIndex(s=>s.id===a);r!==-1&&(t.elements[r]={...t.elements[r],...e})}function F(t,{id:a}){t.elements=t.elements.filter(e=>e.id!==a)}class p extends j{get store(){return f()}async request(){const a=await this.store;a.setLoading(!0);const e=await super.request();return a.setLoading(!1),e}}c(p,"name","operators");const V={id:"039dd848-52a2-4913-8d7e-5108a19a649c",first_name:"Atilio",last_name:"Azino",email:"atilio.azino@bj.com",phone:"229 96 12 34 56",machine:M,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},H=[V];class J extends p{constructor(a={}){super(`/${p.name}`,h.GET,a)}async request(){const a=await super.request();return a instanceof i?a:a.map(e=>new u(e))}async mock(){const a=await this.store;a.elements.length===0&&(a.elements=[...H]);let e=a.elements.map(r=>new u(r));if(this.data&&this.data.search){const r=this.data.search.toLowerCase();e=e.filter(s=>s.first_name.toLowerCase().includes(r)||s.last_name.toLowerCase().includes(r)||s.email.toLowerCase().includes(r)||s.phone&&s.phone.toLowerCase().includes(r))}return e}}async function K(t,{args:a}={}){const r=await new J(a).mock();return r instanceof i||(t.elements=r.map(s=>s.interface)),r}class Q extends p{constructor({elementId:e}){super(`/${p.name}/${e}`,h.GET,{id:e});c(this,"elementId");this.elementId=e}async request(){const e=await super.request();return e instanceof i?e:new u(e)}async mock(){const r=(await this.store).find(this.elementId);return r?new u(r):new O({message:`Utilisateur avec l'ID ${this.elementId} non trouv√©`})}}async function W(t,{elementId:a}){const r=await new Q({elementId:a}).mock();return r instanceof i,r}class X extends p{constructor(e){super(`/${p.name}`,h.POST,e);c(this,"data");this.data=e}async request(){const e=await super.request();return e instanceof i?e:new u(e)}async mock(){const e=await this.store,r=new u({...this.data,id:"1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()});return e.add(r.interface),r}}async function Y(t,{data:a}){const r=await new X(a).mock();return r instanceof i,r}class Z extends p{constructor(e,r){super(`/${p.name}/${e}`,h.PUT,r);c(this,"elementId");this.data=r,this.elementId=e}async request(){const e=await super.request();return e instanceof i?e:new u(e)}async mock(){const e=await this.store,r=e.find(this.elementId);if(!r)return new O({message:`Aucun utilisateur trouv√© avec l'ID ${this.elementId}.`});const s=new u({...r,...this.data,updated_at:new Date().toISOString()});return e.update(this.elementId,s.interface),s}}async function ee(t,{elementId:a,data:e}){const s=await new Z(a,e).mock();return s instanceof i,s}class te extends p{constructor(e){super(`/${p.name}/${e}`,h.DELETE,{elementId:e});c(this,"elementId");this.elementId=e}async request(){const e=await super.request();return e instanceof i?e:new u(e)}async mock(){const e=await this.store,r=e.find(this.elementId);return r?(e.remove(this.elementId),new u(r)):new O({message:`Aucun utilisateur trouv√© avec l'ID ${this.elementId}.`})}}async function re(t,{elementId:a}){const r=await new te(a).mock();return r instanceof i,r}async function ae(t,a={}){t.loading=!0,I.info(`[üçç][${t.$id}]: Executing setOperators()`),t.elements=a.users||[],t.loading=!1,I.success(`[üçç][${t.$id}]: setOperators() completed`)}class se extends p{constructor({elementId:e}){super(`/${p.name}/${e}/publish`,h.PUT);c(this,"elementId");this.elementId=e}async request(){const e=await super.request();return e instanceof i?e:new u(e)}async mock(){const e=await this.store,r=e.find(this.elementId);if(!r)return new O({message:`Aucune operator trouv√©e avec l'ID ${this.elementId}.`});const s=new u({...r,is_active:!0,updated_at:new Date().toISOString()});return await e.update(this.elementId,s.interface),s}}async function ne(t,{elementId:a,mock:e=!1}){const r=new se({elementId:a}),s=e?await r.mock():await r.request();return s instanceof i,s}class oe extends p{constructor({elementId:e}){super(`/${p.name}/${e}/unpublish`,h.PUT);c(this,"elementId");this.elementId=e}async request(){const e=await super.request();return e instanceof i?e:new u(e)}async mock(){const e=await this.store,r=e.find(this.elementId);if(!r)return new O({message:`Aucune operator trouv√©e avec l'ID ${this.elementId}.`});const s=new u({...r,is_active:!1,updated_at:new Date().toISOString()});return await e.update(this.elementId,s.interface),s}}async function ie(t,{elementId:a,mock:e=!1}){const r=new oe({elementId:a});console.log(r);const s=e?await r.mock():await r.request();return s instanceof i,s}const l={setOperators:ae,...U(g.service),add:P,find:B,update:G,remove:F,getOperators:K,findOperator:W,createOperator:Y,updateOperator:ee,updateOperatorActivate:ne,updateOperatorDeactivate:ie,deleteOperator:re},ue=T(g.key,{state:()=>structuredClone(g.service.defaults),getters:N,actions:{add(t){return l.add(this,t)},find(t){return l.find(this,{id:t})},update(t,a){return l.update(this,{id:t,data:a})},remove(t){return l.remove(this,{id:t})},getOperators(t){return l.getOperators(this,{args:t})},findOperator(t){return l.findOperator(this,{elementId:t})},createOperator(t){return l.createOperator(this,{data:t})},updateOperator(t,a){return l.updateOperator(this,{elementId:t,data:a})},updateOperatorActivate(t){return l.updateOperatorActivate(this,{elementId:t,mock:!0})},updateOperatorDeactivate(t){return l.updateOperatorDeactivate(this,{elementId:t,mock:!0})},deleteOperator(t){return l.deleteOperator(this,{elementId:t})},initialize({reset:t=!1}={}){return l.initialize(this,{reset:t})},setLoading(t){return l.setLoading(this,t)},setOperators(t){return l.setOperators(this,t)}}});async function f(){const t=ue();return t.initialized||await t.initialize({reset:!1}),t}const v=z("use_operator_actions"),me=()=>{const t=y(null),a=y([]),e=L(()=>t.value?t.value.loading:!0),r=async()=>{t.value||(t.value=await f());const n=await t.value.getOperators();if(n instanceof i)return v.error("Error fetching operators:",{result:n}),d.error("Erreur lors de la r√©cup√©ration des operateurs"),[];a.value=[...n]},s=async n=>{t.value||(t.value=await f());const o=await t.value.findOperator(n);return o instanceof i?(v.error("Error finding operator:",o),d.error(`Erreur lors de la recherche de l'op√©rateur avec l'ID ${n}`),null):(d.success(`Op√©rateur avec l'ID ${n} trouv√© avec succ√®s.`),new u(o.interface))},S=async n=>{t.value||(t.value=await f());const o=await t.value.createOperator(n);return o instanceof i?(v.error("Error creating operator:",o),d.error(`Erreur lors de la cr√©ation de l'op√©rateur: ${o.message}`),o):(d.success("Op√©rateur cr√©√© avec succ√®s."),new u(o.interface))},k=async(n,o)=>{t.value||(t.value=await f());const m=await t.value.updateOperator(n,o);return m instanceof i?(v.error("Error updating operator:",m),d.error(`Erreur lors de la mise √† jour de l'op√©rateur: ${m.message}`),m):(d.success("Op√©rateur mis √† jour avec succ√®s."),new u(m.interface))},A=async(n,o,m)=>{const E=o?"de d√©sactiver":"de activer";D.showAlert({title:"√ätes-vous s√ªr ?",html:`Vous √™tes sur le point ${E} l'op√©rateur <b class="font-mono">${m.first_name} ${m.last_name}</b> .
          √ätes-vous s√ªr de vouloir continuer ?<br><br> Cette action est <b class="text-pink-950">irr√©versible</b>`,confirmButtonText:`Oui, ${o?"D√©sactiver":"Activer"}`,onConfirm:async()=>{var _,$;let w;if(o?w=await((_=t.value)==null?void 0:_.updateOperatorDeactivate(n)):w=await(($=t.value)==null?void 0:$.updateOperatorActivate(n)),w instanceof i)return v.error(`Error ${o?"la desactivation":"l'activation"} de l'op√©rateur:`,w),d.error(`Erreur lors de  ${o?"la desactivation":"l'activation"} de l'op√©rateur: ${w.message}`),w;d.success(`${o?"D√©sactivation":"Activation"} de l'op√©rateur r√©ussie!`),await r()}})},R=async n=>{D.showAlert({title:"√ätes-vous s√ªr?",html:`Vous √™tes sur le point de supprimer l'op√©rateur <b class="font-mono">${n.first_name} ${n.last_name}</b>. Cette action est <b class="text-pink-950">irr√©versible</b>`,confirmButtonText:"Oui, supprimer",onConfirm:async()=>{t.value||(t.value=await f());const o=await t.value.deleteOperator(n.id);return o instanceof i?(v.error("Error deleting operator:",o),d.error(`Erreur lors de la suppression de l'op√©rateur: ${o.message}`),!1):(d.success(`Utilisateur ${n.first_name} ${n.last_name} supprim√© avec succ√®s.`),r(),!0)}})};return C(async()=>{t.value=await f(),a.value=t.value.elements.map(n=>new u(n))}),{processing:e,operators:a,getOperators:r,findOperator:s,createOperator:S,updateOperator:k,updateOperatorActivateOrDeactivate:A,deleteOperator:R}};export{u as O,f as a,me as u};
