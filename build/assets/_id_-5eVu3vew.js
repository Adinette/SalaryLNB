import{_ as S}from"./BasePageHeading.vue_vue_type_script_setup_true_lang-D3hGS5P4.js";import{_ as B}from"./OperatorForm.vue_vue_type_script_setup_true_lang-DfyGOe3Q.js";import{_ as U}from"./BaseBlock.vue_vue_type_script_setup_true_lang-BhfpUZf_.js";import{u as $,a as C,O as N}from"./use_operator_actions-DfzruNlO.js";import{d as y,a3 as j,N as R,c as T,k as u,m as z,f as I,o as E,w as d,b as n,h as c,i as _,n as P,a4 as v,a0 as W,a2 as g,q,a as D,g as b,F as H}from"./index-djH96c7W.js";import{A as h,U as G}from"./api_route-BfCuro4K.js";import{b as O}from"./route-block-B_A1xBdJ.js";import"./index-C-RzZ9jy.js";import"./use_machine_actions-JCCI023B.js";import"./machines-DgIDqdM-.js";import"./VRow-DOGGYPzI.js";import"./createSimpleFunctional-CGAgNBGN.js";import"./VInput-CtsUFMyD.js";import"./index-BQUvywfj.js";import"./VTextField-BiIaNMKF.js";import"./VAutocomplete-DEo5Cp29.js";import"./VSelect-D7Z0k7d_.js";import"./VMenu-C6zDN-ie.js";import"./VAvatar-DCqiVCq3.js";import"./VChip-CI_Lgiys.js";const J={class:"pb-8"},w="Modifier l'opérateur",K="Enregistrer",Q="fa fa-floppy-o",X=y({__name:"OperatorEditView",setup(k){const s=j("operatorEditView"),a=R(),p=T(()=>!!a.params.id),r=u(null),l=u({first_name:"",last_name:"",email:"",phone:"",machine_id:""}),i=u({first_name:[],last_name:[],email:[],phone:[],machine_id:[]}),m=u(null),{processing:f}=$(),x=t=>{i.value.first_name=t.data.first_name||[],i.value.last_name=t.data.last_name||[],i.value.email=t.data.email||[],i.value.phone=t.data.phone||[],i.value.machine_id=t.data.machine_id||[]},V=async()=>{r.value||(r.value=await C());const t=a.params.id;await r.value.getOperators();const e=await r.value.findOperator(t);if(e instanceof h){m.value={type:"danger",id:"0012",title:"Erreur",message:e.message};return}const o=new N(e.interface);l.value={first_name:o.first_name,last_name:o.last_name,email:o.email,phone:o.phone?v.formatPhoneWithSpaces(o.phone):"",machine_id:o.machine_id||""}},A=async t=>{if(!r.value)return s.error("Le store opérateur n'est pas initialisé."),!1;s.info("Mise à jour de l'opérateur",t);const e=await r.value.updateOperator(a.params.id,t);return e instanceof h?(e instanceof G?x(e):(g.error(e.message),s.error("Erreur lors de la mise à jour de l'opérateur",e)),m.value={type:"danger",id:"0012",title:"Erreur",message:e.message},!1):(s.info("Opérateur mis à jour avec succès",e),g.success("Opérateur modifié avec succès !"),!0)},F=()=>{i.value={first_name:[],last_name:[],email:[],phone:[],machine_id:[]},m.value=null},L=async()=>{if(F(),!r.value){s.error("Le store operator n'est pas initialisé.");return}s.info("Soumission du formulaire d'operateur",l.value),await A({...l.value,phone:v.removeWhitespace(l.value.phone)})&&W.push("/operators")};return z(async()=>{await V()}),(t,e)=>{const o=B;return E(),I(U,{title:w,class:P(["block-mode-loading-oneui",{"block-mode-loading":_(f)}])},{default:d(()=>[n("div",J,[c(o,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=M=>l.value=M),loading:_(f),errors:i.value,alert:m.value,"action-description":w,"action-text":K,"action-icon":Q,"is-edit-mode":p.value,onSubmit:L},null,8,["modelValue","loading","errors","alert","is-edit-mode"])])]),_:1},8,["class"])}}}),Y={"aria-label":"breadcrumb"},Z={class:"breadcrumb breadcrumb-alt"},ee={class:"breadcrumb-item","aria-current":"page"},ae={class:"content"},te="Formulaire des Opérateurs",re="Modifier un Opérateurs.",oe=y({__name:"[id]",setup(k){return(s,a)=>{const p=q("RouterLink"),r=S;return E(),D(H,null,[c(r,{title:te,subtitle:re},{extra:d(()=>[n("nav",Y,[n("ol",Z,[a[1]||(a[1]=n("li",{class:"breadcrumb-item","aria-current":"page"},"Opérateurs",-1)),n("li",ee,[c(p,{to:"/operators"},{default:d(()=>[...a[0]||(a[0]=[b(" Liste des Opérateurs",-1)])]),_:1})]),a[2]||(a[2]=b()),a[3]||(a[3]=n("li",{class:"breadcrumb-item active","aria-current":"page"},"Formulaire des Opérateurs",-1))])])]),_:1}),n("div",ae,[c(X)])],64)}}});typeof O=="function"&&O(oe);export{oe as default};
