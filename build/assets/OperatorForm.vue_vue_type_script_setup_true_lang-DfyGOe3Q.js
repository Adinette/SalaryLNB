import{d as h,k as w,m as M,R as E,c as C,B as S,f as k,o as B,y as z,w as o,h as a,e as A,b as v,g as d,i as m,z as I,ac as L,t as F,V as P}from"./index-djH96c7W.js";import{r as f,e as q,p as $}from"./index-C-RzZ9jy.js";import{u as j}from"./use_machine_actions-JCCI023B.js";import{V as J,a as b,b as O}from"./VRow-DOGGYPzI.js";import{V as n,a as c}from"./VTextField-BiIaNMKF.js";import{a as p}from"./VInput-CtsUFMyD.js";import{V as G}from"./VAutocomplete-DEo5Cp29.js";import{b as H}from"./VMenu-C6zDN-ie.js";const le=h({__name:"OperatorForm",props:{modelValue:{},loading:{type:Boolean},errors:{},alert:{},actionDescription:{},actionText:{},actionIcon:{},isEditMode:{type:Boolean}},emits:["update:modelValue","submit"],setup(D,{emit:N}){const t=D,g=N,{machines:y,getMachines:R}=j(),x=w(),r=w({...t.modelValue});M(async()=>{await Promise.all([R()])}),E(()=>t.modelValue,i=>{r.value={...i}});function u(i,e){r.value[i]=e,g("update:modelValue",{...r.value})}async function T(){var e;const i=await((e=x.value)==null?void 0:e.validate());i&&i.valid&&(console.log(r.value,"localForm.value"),g("submit"))}E(y,i=>{console.log("Machines reçues :",i)});const _=C(()=>{var i;return((i=y.value)==null?void 0:i.filter(e=>e.is_active&&(!e.operator_id||e.operator_id===null)).map(e=>({...e,label:`${e.code} - ${e.emplacement}`,id:e.id})))||[]});return M(async()=>{console.log(_.value,"formattedMachine")}),(i,e)=>{const U=S("maska");return B(),k(J,{ref_key:"formRef",ref:x,onSubmit:z(T,["prevent"])},{default:o(()=>[a(b,null,{default:o(()=>[a(n,{cols:"12",class:"text-left"},{default:o(()=>[...e[10]||(e[10]=[v("span",{class:"text-subtitle-1"},"Remplissez les informations de l'opérateur",-1),v("br",null,null,-1),v("span",{class:"text-subtitle-2 text-muted"},"Les champs marqués d'un * sont obligatoires",-1)])]),_:1}),a(n,{cols:"12",md:"6"},{default:o(()=>{var s;return[a(p,{class:"mb-3",for:"operator-first-name"},{default:o(()=>[...e[11]||(e[11]=[d("Prénom *",-1)])]),_:1}),a(c,{id:"operator-first-name",modelValue:r.value.first_name,"onUpdate:modelValue":[e[0]||(e[0]=l=>r.value.first_name=l),e[1]||(e[1]=l=>u("first_name",l))],placeholder:"Ex: Jean",rules:[m(f)],variant:"filled",density:"compact","prepend-inner-icon":"ri-operator-line","persistent-placeholder":"","error-messages":(s=t.errors)==null?void 0:s.first_name},null,8,["modelValue","rules","error-messages"])]}),_:1}),a(n,{cols:"12",md:"6"},{default:o(()=>{var s;return[a(p,{class:"mb-3",for:"operator-last-name"},{default:o(()=>[...e[12]||(e[12]=[d("Nom *",-1)])]),_:1}),a(c,{id:"operator-last-name",modelValue:r.value.last_name,"onUpdate:modelValue":[e[2]||(e[2]=l=>r.value.last_name=l),e[3]||(e[3]=l=>u("last_name",l))],placeholder:"Ex: Dupont",rules:[m(f)],variant:"filled",density:"compact","prepend-inner-icon":"ri-operator-line","persistent-placeholder":"","error-messages":(s=t.errors)==null?void 0:s.last_name},null,8,["modelValue","rules","error-messages"])]}),_:1}),a(n,{cols:"12",md:"6"},{default:o(()=>{var s;return[a(p,{class:"mb-3",for:"operator-email"},{default:o(()=>[...e[13]||(e[13]=[d("Email *",-1)])]),_:1}),a(c,{id:"operator-email",modelValue:r.value.email,"onUpdate:modelValue":[e[4]||(e[4]=l=>r.value.email=l),e[5]||(e[5]=l=>u("email",l))],placeholder:"Ex: jean.dupont@example.com",rules:[m(f),m(q)],variant:"filled",density:"compact","prepend-inner-icon":"ri-mail-line",disabled:t.isEditMode,"persistent-placeholder":"","error-messages":(s=t.errors)==null?void 0:s.email},null,8,["modelValue","rules","disabled","error-messages"])]}),_:1}),a(n,{cols:"12",md:"6"},{default:o(()=>{var s;return[a(p,{class:"mb-3",for:"operator-phone"},{default:o(()=>[...e[14]||(e[14]=[d("Téléphone",-1)])]),_:1}),I(a(c,{id:"operator-phone",modelValue:r.value.phone,"onUpdate:modelValue":[e[6]||(e[6]=l=>r.value.phone=l),e[7]||(e[7]=l=>u("phone",l))],placeholder:"Ex: 229 01 66 66 66 66",variant:"filled",density:"compact","prepend-inner-icon":"ri-phone-line",disabled:t.isEditMode,"persistent-placeholder":"",rules:[m($)],"error-messages":(s=t.errors)==null?void 0:s.phone},null,8,["modelValue","disabled","rules","error-messages"]),[[U,"229 01 ## ## ## ##"]])]}),_:1}),a(n,{cols:"12",md:"6"},{default:o(()=>{var s;return[a(p,{class:"mb-3",for:"operator-machine"},{default:o(()=>[...e[15]||(e[15]=[d("Machine attribuée *",-1)])]),_:1}),a(G,{id:"operator-machine",modelValue:r.value.machine_id,"onUpdate:modelValue":[e[8]||(e[8]=l=>r.value.machine_id=l),e[9]||(e[9]=l=>u("machine_id",l))],items:_.value,"item-title":"code","item-value":"id",placeholder:"Sélectionnez une position",variant:"filled",density:"compact","prepend-inner-icon":"ri-briefcase-line",rules:[m(f)],"error-messages":(s=t.errors)==null?void 0:s.machine_id},{item:o(({props:l,item:V})=>[a(H,L(l,{title:V.raw.code+" - "+V.raw.emplacement,subtitle:V.raw.code}),null,16,["title","subtitle"])]),_:1},8,["modelValue","items","rules","error-messages"])]}),_:1})]),_:1}),t.alert?(B(),k(b,{key:0},{default:o(()=>[a(n,{cols:"12"},{default:o(()=>[a(O,{type:t.alert.type==="danger"?"error":t.alert.type,title:t.alert.title,class:"mb-3"},{default:o(()=>[d(F(t.alert.message),1)]),_:1},8,["type","title"])]),_:1})]),_:1})):A("",!0),a(b,null,{default:o(()=>[a(n,{cols:"12",class:"text-right"},{default:o(()=>[a(P,{type:"submit",color:"success",loading:t.loading,"prepend-icon":t.actionIcon,class:"px-8"},{default:o(()=>[d(F(t.actionText||"Enregistrer"),1)]),_:1},8,["loading","prepend-icon"])]),_:1})]),_:1})]),_:1},512)}}});export{le as _};
