import{_ as B}from"./BasePageHeading.vue_vue_type_script_setup_true_lang-D3hGS5P4.js";import{_ as S}from"./MachineForm.vue_vue_type_script_setup_true_lang-C7I5FcSl.js";import{_ as $}from"./BaseBlock.vue_vue_type_script_setup_true_lang-BhfpUZf_.js";import{u as C,a as N,M as U}from"./use_machine_actions-JCCI023B.js";import{d as E,a3 as j,N as R,c as T,k as m,m as z,f as I,o as w,w as p,b as o,h as u,i as _,n as q,a0 as D,a2 as v,q as H,a as P,g,F as G}from"./index-djH96c7W.js";import{A as h,U as J}from"./api_route-BfCuro4K.js";import{b}from"./route-block-B_A1xBdJ.js";import"./index-C-RzZ9jy.js";import"./VRow-DOGGYPzI.js";import"./createSimpleFunctional-CGAgNBGN.js";import"./VInput-CtsUFMyD.js";import"./index-BQUvywfj.js";import"./VTextField-BiIaNMKF.js";import"./machines-DgIDqdM-.js";const K={class:"pb-8"},M="Modifier la machine",O="Enregistrer",Q="fa fa-floppy-o",W=E({__name:"MachineEditView",setup(y){const i=j("machineEditView"),a=R(),d=T(()=>!!a.params.id),t=m(null),n=m({code:"",emplacement:"",is_active:!1}),c=m({code:[],emplacement:[],is_active:[]}),l=m(null),{processing:f}=C(),k=s=>{c.value.code=s.data.code||[],c.value.emplacement=s.data.emplacement||[]},x=async()=>{t.value||(t.value=await N());const s=a.params.id;await t.value.getMachines();const e=await t.value.findMachine(s);if(e instanceof h){l.value={type:"danger",id:"0012",title:"Erreur",message:e.message};return}const r=new U(e.interface);n.value={code:r.code,emplacement:r.emplacement,is_active:r.is_active}},V=async s=>{if(!t.value)return i.error("Le store machine n'est pas initialisé."),!1;i.info("Mise à jour de la machine",s);const e=await t.value.updateMachine(a.params.id,s);return e instanceof h?(e instanceof J?k(e):(v.error(e.message),i.error("Erreur lors de la mise à jour de la machine",e)),l.value={type:"danger",id:"0012",title:"Erreur",message:e.message},!1):(i.info("Machine mise à jour avec succès",e),v.success("Machine modifiée avec succès !"),!0)},F=()=>{c.value={code:[],emplacement:[],is_active:[]},l.value=null},L=async()=>{if(F(),!t.value){i.error("Le store machine n'est pas initialisé.");return}i.info("Soumission du formulaire de machine",n.value),await V({...n.value})&&D.push("/machines")};return z(async()=>{await x()}),(s,e)=>{const r=S;return w(),I($,{title:M,class:q(["block-mode-loading-oneui",{"block-mode-loading":_(f)}])},{default:p(()=>[o("div",K,[u(r,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=A=>n.value=A),loading:_(f),errors:c.value,alert:l.value,"action-description":M,"action-text":O,"action-icon":Q,"is-edit-mode":d.value,onSubmit:L},null,8,["modelValue","loading","errors","alert","is-edit-mode"])])]),_:1},8,["class"])}}}),X={"aria-label":"breadcrumb"},Y={class:"breadcrumb breadcrumb-alt"},Z={class:"breadcrumb-item","aria-current":"page"},ee={class:"content"},ae="Formulaire des machines",te="Modifier une machine.",se=E({__name:"[id]",setup(y){return(i,a)=>{const d=H("RouterLink"),t=B;return w(),P(G,null,[u(t,{title:ae,subtitle:te},{extra:p(()=>[o("nav",X,[o("ol",Y,[a[1]||(a[1]=o("li",{class:"breadcrumb-item","aria-current":"page"},"Machines",-1)),o("li",Z,[u(d,{to:"/machines"},{default:p(()=>[...a[0]||(a[0]=[g(" Liste des machines",-1)])]),_:1})]),a[2]||(a[2]=g()),a[3]||(a[3]=o("li",{class:"breadcrumb-item active","aria-current":"page"},"Formulaire de modification des machines",-1))])])]),_:1}),o("div",ee,[u(W)])],64)}}});typeof b=="function"&&b(se);export{se as default};
