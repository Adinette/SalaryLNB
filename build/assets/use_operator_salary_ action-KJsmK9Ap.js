var $=Object.defineProperty;var I=(e,r,t)=>r in e?$(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var i=(e,r,t)=>I(e,typeof r!="symbol"?r+"":r,t);import{ag as M,ah as A,ai as C,bN as v,ak as E,k as b,c as _,m as x,a4 as B,a3 as R,a2 as d}from"./index-djH96c7W.js";import{a as k,b as y,A as u,N as O}from"./api_route-BfCuro4K.js";class c extends M{constructor(t){super(t);i(this,"chiffreAffaireMensuelttc");i(this,"percentCommissionBrute");i(this,"dette");i(this,"remboursement");i(this,"ecart");i(this,"date");i(this,"percentFraisMomo");i(this,"payement");i(this,"operator");i(this,"operator_id");this.chiffreAffaireMensuelttc=t.chiffreAffaireMensuelttc,this.percentCommissionBrute=t.percentCommissionBrute,this.dette=t.dette,this.remboursement=t.remboursement,this.ecart=t.ecart,this.date=t.date,this.percentFraisMomo=t.percentFraisMomo,this.payement=t.payement,this.operator=t.operator,this.operator_id=t.operator_id}get interface(){return{...super.interface,chiffreAffaireMensuelttc:this.chiffreAffaireMensuelttc,percentCommissionBrute:this.percentCommissionBrute,dette:this.dette,remboursement:this.remboursement,ecart:this.ecart,date:this.date,percentFraisMomo:this.percentFraisMomo,payement:this.payement,operator:this.operator,operator_id:this.operator_id,chiffreAffaireHorsTaxe:this.chiffreAffaireHorsTaxe,commissionBrute:this.commissionBrute,aib:this.aib,fel:this.fel,penalite:this.penalite,calculatedFraisMomo:this.calculatedFraisMomo,totalPrelevements:this.totalPrelevements,salaireBrut:this.salaireBrut}}get chiffreAffaireHorsTaxe(){return this.chiffreAffaireMensuelttc/1.1}get commissionBrute(){return this.chiffreAffaireHorsTaxe*(this.percentCommissionBrute/100)}get aib(){return this.commissionBrute*.05}get fel(){return 2500}get penalite(){return(this.ecart||0)*.15}get calculatedFraisMomo(){return(this.payement||0)*(this.percentFraisMomo||0)/100}get autresPrelevements(){return Number(this.penalite||0)+Number(this.remboursement||0)+Number(this.dette||0)+Number(this.ecart||0)+Number(this.calculatedFraisMomo||0)}get totalPrelevements(){return this.fel+this.aib+this.autresPrelevements}get salaireBrut(){return this.commissionBrute-this.totalPrelevements}get netSalary(){return this.salaireBrut}}const L={};function T(e,r){e.elements.push(r)}function q(e,{id:r}){return e.elements.find(t=>t.id===r)}function D(e,{id:r,data:t}){const a=e.elements.findIndex(o=>o.id===r);a!==-1&&(e.elements[a]={...e.elements[a],...t})}function F(e,{id:r}){e.elements=e.elements.filter(t=>t.id!==r)}class p extends k{get store(){return f()}async request(){const r=await this.store;r.setLoading(!0);const t=await super.request();return r.setLoading(!1),t}}i(p,"name","operatorSalary");class P extends p{constructor(r={}){super(`/${p.name}`,y.GET,r)}async request(){const r=await super.request();return r instanceof u?r:r.map(t=>new c(t))}async mock(){var S,w,g;let t=(await this.store).elements.map(s=>new c(s));const a=(S=this.data)==null?void 0:S.operator_id;a&&(t=t.filter(s=>String(s.operator_id)===String(a)));const o=(g=(w=this.data)==null?void 0:w.search)==null?void 0:g.toLowerCase();return o&&(t=t.filter(s=>s.first_name.toLowerCase().includes(o)||s.last_name.toLowerCase().includes(o)||s.email.toLowerCase().includes(o)||s.phone&&s.phone.toLowerCase().includes(o))),t}}async function N(e,{args:r}={}){const a=await new P(r).mock();return a instanceof u||(e.elements=a.map(o=>o.interface)),a}class U extends p{constructor({elementId:t}){super(`/${p.name}/${t}`,y.GET,{id:t});i(this,"elementId");this.elementId=t}async request(){const t=await super.request();return t instanceof u?t:new c(t)}async mock(){const a=(await this.store).find(this.elementId);return a?new c(a):new O({message:`Utilisateur avec l'ID ${this.elementId} non trouv√©`})}}async function z(e,{elementId:r}){const a=await new U({elementId:r}).mock();return a instanceof u,a}class H extends p{constructor(t){super(`/${p.name}`,y.POST,t);i(this,"data");this.data=t}async request(){const t=await super.request();return t instanceof u?t:new c(t)}async mock(){const t=await this.store,a=new c({...this.data,id:"1",created_at:new Date().toISOString(),updated_at:new Date().toISOString()});return t.add(a.interface),a}}async function G(e,{data:r}){const a=await new H(r).mock();return a instanceof u,a}class j extends p{constructor(t,a){super(`/${p.name}/${t}`,y.PUT,a);i(this,"elementId");this.data=a,this.elementId=t}async request(){const t=await super.request();return t instanceof u?t:new c(t)}async mock(){const t=await this.store,a=t.find(this.elementId);if(!a)return new O({message:`Aucun utilisateur trouv√© avec l'ID ${this.elementId}.`});const o=new c({...a,...this.data,updated_at:new Date().toISOString()});return t.update(this.elementId,o.interface),o}}async function V(e,{elementId:r,data:t}){const o=await new j(r,t).mock();return o instanceof u,o}class J extends p{constructor(t){super(`/${p.name}/${t}`,y.DELETE,{elementId:t});i(this,"elementId");this.elementId=t}async request(){const t=await super.request();return t instanceof u?t:new c(t)}async mock(){const t=await this.store,a=t.find(this.elementId);return a?(t.remove(this.elementId),new c(a)):new O({message:`Aucun utilisateur trouv√© avec l'ID ${this.elementId}.`})}}async function K(e,{elementId:r}){const a=await new J(r).mock();return a instanceof u,a}async function Q(e,r={}){e.loading=!0,A.info(`[üçç][${e.$id}]: Executing setOperatorSalarys()`),e.elements=r.users||[],e.loading=!1,A.success(`[üçç][${e.$id}]: setOperatorSalarys() completed`)}const l={setOperatorSalary:Q,...C(v.service),add:T,find:q,update:D,remove:F,getOperatorSalary:N,findOperatorSalary:z,createOperatorSalary:G,updateOperatorSalary:V,deleteOperatorSalary:K},W=E(v.key,{state:()=>structuredClone(v.service.defaults),getters:L,actions:{add(e){return l.add(this,e)},find(e){return l.find(this,{id:e})},update(e,r){return l.update(this,{id:e,data:r})},remove(e){return l.remove(this,{id:e})},getOperatorSalarys(e){return l.getOperatorSalary(this,{args:e})},findOperatorSalary(e){return l.findOperatorSalary(this,{elementId:e})},createOperatorSalary(e){return l.createOperatorSalary(this,{data:e})},updateOperatorSalary(e,r){return l.updateOperatorSalary(this,{elementId:e,data:r})},deleteOperatorSalary(e){return l.deleteOperatorSalary(this,{elementId:e})},initialize({reset:e=!1}={}){return l.initialize(this,{reset:e})},setLoading(e){return l.setLoading(this,e)},setOperatorSalarys(e){return l.setOperatorSalary(this,e)}}});async function f(){const e=W();return e.initialized||await e.initialize({reset:!1}),e}const h=R("use_operator_actions"),ee=()=>{const e=b(null),r=b([]),t=_(()=>e.value?e.value.loading:!0),a=async s=>{e.value||(e.value=await f());const n=await e.value.getOperatorSalarys(s);if(n instanceof u)return h.error("Error fetching operatorSalary:",{result:n}),d.error("Erreur lors de la r√©cup√©ration des utilisateurs"),[];r.value=[...n]},o=async s=>{e.value||(e.value=await f());const n=await e.value.findOperatorSalary(s);return n instanceof u?(h.error("Error finding operatorSalary:",n),d.error(`Erreur lors de la recherche du calcul du salaire de l'op√©rateur avec l'ID ${s}`),null):(d.success(`Calcul du salaire de l'op√©rateur avec l'ID ${s} trouv√© avec succ√®s.`),new c(n.interface))},S=async s=>{e.value||(e.value=await f());const n=await e.value.createOperatorSalary(s);return n instanceof u?(h.error("Error creating operatorSalary:",n),d.error(`Erreur lors du calcul du salaire de l'op√©rateur: ${n.message}`),n):(d.success("Calcul du salaire de l'op√©rateur cr√©√© avec succ√®s."),new c(n.interface))},w=async(s,n)=>{e.value||(e.value=await f());const m=await e.value.updateOperatorSalary(s,n);return m instanceof u?(h.error("Error updating operatorSalary:",m),d.error(`Erreur lors de la mise √† jour du calcul du salaire de l'op√©rateur: ${m.message}`),m):(d.success("Calcul du salaire de l'op√©rateur mis √† jour avec succ√®s."),new c(m.interface))},g=async s=>{B.showAlert({title:"√ätes-vous s√ªr?",html:`Vous √™tes sur le point de supprimer le calcul du salaire de l'op√©rateur √† la date <b class="font-mono">${s.date}</b>. Cette action est <b class="text-pink-950">irr√©versible</b>`,confirmButtonText:"Oui, supprimer",onConfirm:async()=>{e.value||(e.value=await f());const n=await e.value.deleteOperatorSalary(s.id);return n instanceof u?(h.error("Error deleting operatorSalary:",n),d.error(`Erreur lors de la suppression du  l'op√©rateur: ${n.message}`),!1):(d.success(`Calcul du salaire de l'op√©rateur √† la date ${s.date} supprim√© avec succ√®s.`),a(),!0)}})};return x(async()=>{e.value=await f(),r.value=e.value.elements.map(s=>new c(s))}),{processing:t,operatorSalary:r,getOperatorSalary:a,findOperatorSalary:o,createOperatorSalary:S,updateOperatorSalary:w,deleteOperatorSalary:g}};export{c as O,f as a,ee as u};
